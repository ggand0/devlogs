# Ubuntu 24.04 Upgrade Log

**Date:** 2025-01-04
**Upgrade:** Ubuntu 22.04.5 LTS â†’ Ubuntu 24.04 LTS (Noble Numbat)

## Pre-Upgrade Blockers

### PostgreSQL Removal Required

Upgrade failed twice due to PostgreSQL packages in removal deny list:
```
The package 'postgresql-12' is marked for removal but it is in the removal deny list.
The package 'postgresql-15' is marked for removal but it is in the removal deny list.
```

**Solution:**
```bash
sudo apt purge postgresql*
sudo apt autoremove
```

## Configuration File Choices

During upgrade, several config files had local modifications. Choices made:

| File | Choice | Reason |
|------|--------|--------|
| `/etc/security/limits.conf` | **N** (keep local) | Contains custom resource limits for ROCm/GPU workloads |
| `/etc/adduser.conf` | **N** (keep local) | Default user creation settings, not critical but safe to keep |
| `/etc/default/grub` | **Keep local** | Contains AMD GPU stability parameters: `amdgpu.gfxoff=0 amdgpu.tmz=0 amdgpu.runpm=0` |

## Errors During Upgrade

```
Errors were encountered while processing:
 libvlc-bin:amd64
 mesa-amdgpu-vdpau-drivers:amd64
```

These are non-critical:
- `libvlc-bin` - VLC media player component
- `mesa-amdgpu-vdpau-drivers` - AMD video decode drivers (will be replaced during ROCm reinstall)

**Post-reboot fix:**
```bash
sudo apt --fix-broken install
sudo apt install --reinstall libvlc-bin mesa-amdgpu-vdpau-drivers
```

## Third-Party Repos Disabled

The upgrade automatically disabled third-party sources:
- ROCm repository (repo.radeon.com)
- Any PPAs

These need to be re-enabled/re-added after upgrade. See [016_2025-01-04-ubuntu-24.04-upgrade-rocm-reinstall.md](016_2025-01-04-ubuntu-24.04-upgrade-rocm-reinstall.md) for ROCm reinstallation steps.

## Post-Upgrade TODO

1. [ ] Reboot into 24.04
2. [ ] Verify GRUB params preserved: `cat /proc/cmdline`
3. [ ] Fix broken packages: `sudo apt --fix-broken install`
4. [ ] Reinstall ROCm (see devlog 016)
5. [ ] Verify GPU: `rocm-smi`, `rocminfo`
6. [ ] Test PyTorch: `python3 -c "import torch; print(torch.cuda.is_available())"`
